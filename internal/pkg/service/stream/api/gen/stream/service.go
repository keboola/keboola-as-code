// Code generated by goa v3.16.1, DO NOT EDIT.
//
// stream service
//
// Command:
// $ goa gen github.com/keboola/keboola-as-code/api/stream --output
// ./internal/pkg/service/stream/api

package stream

import (
	"context"

	"github.com/keboola/go-client/pkg/keboola"
	"github.com/keboola/keboola-as-code/internal/pkg/service/common/task"
	"github.com/keboola/keboola-as-code/internal/pkg/service/stream/definition"
	"github.com/keboola/keboola-as-code/internal/pkg/service/stream/definition/key"
	dependencies "github.com/keboola/keboola-as-code/internal/pkg/service/stream/dependencies"
	"github.com/keboola/keboola-as-code/internal/pkg/service/stream/mapping/table/column"
	"goa.design/goa/v3/security"
)

// A service for continuously importing data to the Keboola platform.
type Service interface {
	// Redirect to /v1.
	APIRootIndex(context.Context, dependencies.PublicRequestScope) (err error)
	// List API name and link to documentation.
	APIVersionIndex(context.Context, dependencies.PublicRequestScope) (res *ServiceDetail, err error)
	// HealthCheck implements HealthCheck.
	HealthCheck(context.Context, dependencies.PublicRequestScope) (res string, err error)
	// Create a new source in the branch.
	CreateSource(context.Context, dependencies.BranchRequestScope, *CreateSourcePayload) (res *Task, err error)
	// Update the source.
	UpdateSource(context.Context, dependencies.SourceRequestScope, *UpdateSourcePayload) (res *Task, err error)
	// List all sources in the branch.
	ListSources(context.Context, dependencies.BranchRequestScope, *ListSourcesPayload) (res *SourcesList, err error)
	// Get the source definition.
	GetSource(context.Context, dependencies.SourceRequestScope, *GetSourcePayload) (res *Source, err error)
	// Delete the source.
	DeleteSource(context.Context, dependencies.SourceRequestScope, *DeleteSourcePayload) (err error)
	// Get source settings.
	GetSourceSettings(context.Context, dependencies.SourceRequestScope, *GetSourceSettingsPayload) (res *SettingsResult, err error)
	// Update source settings.
	UpdateSourceSettings(context.Context, dependencies.SourceRequestScope, *UpdateSourceSettingsPayload) (res *SettingsResult, err error)
	// Each sink uses its own token scoped to the target bucket, this endpoint
	// refreshes all of those tokens.
	RefreshSourceTokens(context.Context, dependencies.SourceRequestScope, *RefreshSourceTokensPayload) (res *Source, err error)
	// Create a new sink in the source.
	CreateSink(context.Context, dependencies.SourceRequestScope, *CreateSinkPayload) (res *Task, err error)
	// Get the sink definition.
	GetSink(context.Context, dependencies.SinkRequestScope, *GetSinkPayload) (res *Sink, err error)
	// Get the sink settings.
	GetSinkSettings(context.Context, dependencies.SinkRequestScope, *GetSinkSettingsPayload) (res *SettingsResult, err error)
	// Update sink settings.
	UpdateSinkSettings(context.Context, dependencies.SinkRequestScope, *UpdateSinkSettingsPayload) (res *SettingsResult, err error)
	// List all sinks in the source.
	ListSinks(context.Context, dependencies.SourceRequestScope, *ListSinksPayload) (res *SinksList, err error)
	// Update the sink.
	UpdateSink(context.Context, dependencies.SinkRequestScope, *UpdateSinkPayload) (res *Task, err error)
	// Delete the sink.
	DeleteSink(context.Context, dependencies.SinkRequestScope, *DeleteSinkPayload) (err error)
	// Get total statistics of the sink.
	SinkStatisticsTotal(context.Context, dependencies.SinkRequestScope, *SinkStatisticsTotalPayload) (res *SinkStatisticsTotalResult, err error)
	// Get details of a task.
	GetTask(context.Context, dependencies.ProjectRequestScope, *GetTaskPayload) (res *Task, err error)
}

// Auther defines the authorization functions to be implemented by the service.
type Auther interface {
	// APIKeyAuth implements the authorization logic for the APIKey security scheme.
	APIKeyAuth(ctx context.Context, key string, schema *security.APIKeyScheme) (context.Context, error)
}

// APIName is the name of the API as defined in the design.
const APIName = "stream"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "1.0"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "stream"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [20]string{"ApiRootIndex", "ApiVersionIndex", "HealthCheck", "CreateSource", "UpdateSource", "ListSources", "GetSource", "DeleteSource", "GetSourceSettings", "UpdateSourceSettings", "RefreshSourceTokens", "CreateSink", "GetSink", "GetSinkSettings", "UpdateSinkSettings", "ListSinks", "UpdateSink", "DeleteSink", "SinkStatisticsTotal", "GetTask"}

// ID of the branch.
type BranchID = keboola.BranchID

// ID of the branch or "default".
type BranchIDOrDefault = key.BranchIDOrDefault

// Information about the operation actor.
type By struct {
	// Date and time of deletion.
	Type string
	// ID of the token.
	TokenID *string
	// ID of the user.
	UserID *string
	// Description of the user.
	UserDescription *string
}

// CreateSinkPayload is the payload type of the stream service CreateSink
// method.
type CreateSinkPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	// Optional ID, if not filled in, it will be generated from name. Cannot be
	// changed later.
	SinkID *SinkID
	Type   SinkType
	// Human readable name of the sink.
	Name string
	// Description of the source.
	Description *string
	// Table sink configuration for "type" = "table".
	Table *TableSink
}

// CreateSourcePayload is the payload type of the stream service CreateSource
// method.
type CreateSourcePayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	// Optional ID, if not filled in, it will be generated from name. Cannot be
	// changed later.
	SourceID *SourceID
	Type     SourceType
	// Human readable name of the source.
	Name string
	// Description of the source.
	Description *string
}

// DeleteSinkPayload is the payload type of the stream service DeleteSink
// method.
type DeleteSinkPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	SinkID          SinkID
}

// DeleteSourcePayload is the payload type of the stream service DeleteSource
// method.
type DeleteSourcePayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
}

// Information about the deleted entity.
type DeletedEntity struct {
	// Date and time of deletion.
	At string
	// Who deleted the entity, for example "system", "user", ...
	By *By
}

// Information about the disabled entity.
type DisabledEntity struct {
	// Date and time of disabling.
	At string
	// Who disabled the entity, for example "system", "user", ...
	By *By
	// Why was the entity disabled?
	Reason string
}

// Generic error.
type GenericError struct {
	// HTTP status code.
	StatusCode int
	// Name of error.
	Name string
	// Error message.
	Message string
}

// GetSinkPayload is the payload type of the stream service GetSink method.
type GetSinkPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	SinkID          SinkID
}

// GetSinkSettingsPayload is the payload type of the stream service
// GetSinkSettings method.
type GetSinkSettingsPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	SinkID          SinkID
}

// GetSourcePayload is the payload type of the stream service GetSource method.
type GetSourcePayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
}

// GetSourceSettingsPayload is the payload type of the stream service
// GetSourceSettings method.
type GetSourceSettingsPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
}

// GetTaskPayload is the payload type of the stream service GetTask method.
type GetTaskPayload struct {
	StorageAPIToken string
	TaskID          TaskID
}

// GetVersion of the entity.
type GetVersion struct {
	// GetVersion number counted from 1.
	Number definition.VersionNumber
	// Hash of the entity state.
	Hash string
	// Date and time of the modification.
	ModifiedAt string
	// Description of the change.
	Description string
}

// HTTP source details for "type" = "http".
type HTTPSource struct {
	// URL of the HTTP source. Contains secret used for authentication.
	URL string
}

type Level struct {
	FirstRecordAt    string
	LastRecordAt     string
	RecordsCount     uint64
	UncompressedSize uint64
}

type Levels struct {
	Local   *Level
	Staging *Level
	Target  *Level
}

// ListSinksPayload is the payload type of the stream service ListSinks method.
type ListSinksPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	// Request records after the ID.
	SinceID string
	// Maximum number of returned records.
	Limit int
}

// ListSourcesPayload is the payload type of the stream service ListSources
// method.
type ListSourcesPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	// Request records after the ID.
	SinceID string
	// Maximum number of returned records.
	Limit int
}

type PaginatedResponse struct {
	// Current limit.
	Limit int
	// Total count of all records.
	TotalCount int
	// Current offset.
	SinceID string
	// ID of the last record in the response.
	LastID string
}

// ID of the project.
type ProjectID = keboola.ProjectID

// RefreshSourceTokensPayload is the payload type of the stream service
// RefreshSourceTokens method.
type RefreshSourceTokensPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
}

// ServiceDetail is the result type of the stream service ApiVersionIndex
// method.
type ServiceDetail struct {
	// Name of the API
	API string
	// URL of the API documentation.
	Documentation string
}

// One setting key-value pair.
type SettingPatch struct {
	// Key path.
	Key string
	// A new key value. Use null to reset the value to the default value.
	Value any
}

// One setting key-value pair.
type SettingResult struct {
	// Key path.
	Key string
	// Value type.
	Type string
	// Key description.
	Description string
	// Actual value.
	Value any
	// Default value.
	DefaultValue any
	// True, if the default value is locally overwritten.
	Overwritten bool
	// True, if only a super admin can modify the key.
	Protected bool
	// Validation rules as a string definition.
	Validation *string
}

type SettingsPatch []*SettingPatch

// SettingsResult is the result type of the stream service GetSourceSettings
// method.
type SettingsResult struct {
	Settings []*SettingResult
}

// Sink is the result type of the stream service GetSink method.
type Sink struct {
	ProjectID ProjectID
	BranchID  BranchID
	SourceID  SourceID
	SinkID    SinkID
	Type      SinkType
	// Human readable name of the sink.
	Name string
	// Description of the source.
	Description string
	// Table sink configuration for "type" = "table".
	Table    *TableSink
	Version  *GetVersion
	Deleted  *DeletedEntity
	Disabled *DisabledEntity
}

// Unique ID of the sink.
type SinkID = key.SinkID

// SinkStatisticsTotalPayload is the payload type of the stream service
// SinkStatisticsTotal method.
type SinkStatisticsTotalPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	SinkID          SinkID
}

// SinkStatisticsTotalResult is the result type of the stream service
// SinkStatisticsTotal method.
type SinkStatisticsTotalResult struct {
	Total  *Level
	Levels *Levels
}

type SinkType = definition.SinkType

// List of sinks, max 100 sinks per a source.
type Sinks []*Sink

// SinksList is the result type of the stream service ListSinks method.
type SinksList struct {
	ProjectID ProjectID
	BranchID  BranchID
	SourceID  SourceID
	Page      *PaginatedResponse
	Sinks     Sinks
}

// Source is the result type of the stream service GetSource method.
type Source struct {
	ProjectID ProjectID
	BranchID  BranchID
	SourceID  SourceID
	Type      SourceType
	// Human readable name of the source.
	Name string
	// Description of the source.
	Description string
	// HTTP source details for "type" = "http".
	HTTP     *HTTPSource
	Version  *GetVersion
	Deleted  *DeletedEntity
	Disabled *DisabledEntity
	Sinks    Sinks
}

// Unique ID of the source.
type SourceID = key.SourceID

type SourceType = definition.SourceType

// List of sources, max 100 sources per a branch.
type Sources []*Source

// SourcesList is the result type of the stream service ListSources method.
type SourcesList struct {
	ProjectID ProjectID
	BranchID  BranchID
	Page      *PaginatedResponse
	Sources   Sources
}

// An output mapping defined by a template.
type TableColumn struct {
	// Sets this column as a part of the primary key of the destination table.
	PrimaryKey bool
	// Column mapping type. This represents a static mapping (e.g. `body` or
	// `headers`), or a custom mapping using a template language (`template`).
	Type column.Type
	// Column name.
	Name string
	// Template mapping details. Only for "type" = "template".
	Template *TableColumnTemplate
}

// Template column definition, for "type" = "template".
type TableColumnTemplate struct {
	Language string
	Content  string
}

// List of export column mappings. An export may have a maximum of 100 columns.
type TableColumns []*TableColumn

type TableID string

// Table mapping definition.
type TableMapping struct {
	Columns TableColumns
}

// Table sink definition.
type TableSink struct {
	Type    TableType
	TableID TableID
	Mapping *TableMapping
}

type TableType = definition.TableType

// Task is the result type of the stream service CreateSource method.
type Task struct {
	TaskID TaskID
	// Task type.
	Type string
	// URL of the task.
	URL string
	// Task status, one of: processing, success, error
	Status string
	// Shortcut for status != "processing".
	IsFinished bool
	// Date and time of the task creation.
	CreatedAt string
	// Date and time of the task end.
	FinishedAt *string
	// Duration of the task in milliseconds.
	Duration *int64
	Result   *string
	Error    *string
	Outputs  *TaskOutputs
}

// Unique ID of the task.
type TaskID = task.ID

// Outputs generated by the task.
type TaskOutputs struct {
	// Absolute URL of the entity.
	URL *string
	// ID of the parent project.
	ProjectID *ProjectID
	// ID of the parent branch.
	BranchID *BranchID
	// ID of the created/updated source.
	SourceID *SourceID
	// ID of the created/updated sink.
	SinkID *SinkID
}

// UpdateSinkPayload is the payload type of the stream service UpdateSink
// method.
type UpdateSinkPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	SinkID          SinkID
	Type            *SinkType
	// Human readable name of the sink.
	Name *string
	// Description of the source.
	Description *string
	// Table sink configuration for "type" = "table".
	Table *TableSink
	// Description of the modification, description of the version.
	ChangeDescription *string
}

// UpdateSinkSettingsPayload is the payload type of the stream service
// UpdateSinkSettings method.
type UpdateSinkSettingsPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	SinkID          SinkID
	Settings        SettingsPatch
}

// UpdateSourcePayload is the payload type of the stream service UpdateSource
// method.
type UpdateSourcePayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	Type            *SourceType
	// Human readable name of the source.
	Name *string
	// Description of the source.
	Description *string
	// Description of the modification, description of the version.
	ChangeDescription *string
}

// UpdateSourceSettingsPayload is the payload type of the stream service
// UpdateSourceSettings method.
type UpdateSourceSettingsPayload struct {
	StorageAPIToken string
	BranchID        BranchIDOrDefault
	SourceID        SourceID
	// Description of the modification, description of the version.
	ChangeDescription *string
	Settings          SettingsPatch
}

// Error returns an error description.
func (e *GenericError) Error() string {
	return "Generic error."
}

// ErrorName returns "GenericError".
//
// Deprecated: Use GoaErrorName - https://github.com/goadesign/goa/issues/3105
func (e *GenericError) ErrorName() string {
	return e.GoaErrorName()
}

// GoaErrorName returns "GenericError".
func (e *GenericError) GoaErrorName() string {
	return e.Name
}
